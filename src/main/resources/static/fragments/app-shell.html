<div class="app-shell">
    <aside class="sidebar">
        <div class="brand">
            <div class="brand-badge">BD</div>
            <div>
                <strong>BDAS Supermarket</strong>
                <span>Ridici mistnost dat</span>
            </div>
        </div>

        <div class="sidebar-section">
            <h4>Navigace</h4>
            <a class="nav-link" data-view="dashboard" data-url="index.html" href="index.html">
                <span class="material-symbols-rounded" aria-hidden="true">dashboard</span>
                <span>Prehled</span>
            </a>
            <a class="nav-link" data-view="profile" data-url="profile.html" href="profile.html">
                <span class="material-symbols-rounded" aria-hidden="true">badge</span>
                <span>Muj profil</span>
            </a>
            <a class="nav-link" data-view="inventory" data-url="inventory.html" href="inventory.html">
                <span class="material-symbols-rounded" aria-hidden="true">inventory_2</span>
                <span>Sklad</span>
            </a>
            <a class="nav-link" data-view="orders" data-url="orders.html" href="orders.html">
                <span class="material-symbols-rounded" aria-hidden="true">shopping_cart</span>
                <span>Objednavky</span>
            </a>
            <a class="nav-link" data-view="people" data-url="people.html" href="people.html">
                <span class="material-symbols-rounded" aria-hidden="true">groups</span>
                <span>Tym &amp; zakaznici</span>
            </a>
            <a class="nav-link" data-view="finance" data-url="finance.html" href="finance.html">
                <span class="material-symbols-rounded" aria-hidden="true">payments</span>
                <span>Finance</span>
            </a>
            <a class="nav-link" data-view="records" data-url="records.html" href="records.html">
                <span class="material-symbols-rounded" aria-hidden="true">folder_open</span>
                <span>Archiv &amp; audit</span>
            </a>
            <a class="nav-link" data-view="customer" data-url="customer.html" href="customer.html">
                <span class="material-symbols-rounded" aria-hidden="true">shopping_bag</span>
                <span>Zakaznicka zona</span>
            </a>
            <a class="nav-link" data-view="client-orders" data-url="client-orders.html" href="client-orders.html">
                <span class="material-symbols-rounded" aria-hidden="true">assured_workload</span>
                <span>Zakaznicke objednavky</span>
            </a>
            <a class="nav-link" data-view="customer-history" data-url="customer-history.html" href="customer-history.html">
                <span class="material-symbols-rounded" aria-hidden="true">history</span>
                <span>Historie zakaznika</span>
            </a>
            <a class="nav-link" data-view="supplier" data-url="supplier.html" href="supplier.html">
                <span class="material-symbols-rounded" aria-hidden="true">local_shipping</span>
                <span>Dodavatel</span>
            </a>
            <a class="nav-link" data-view="dbobjects" data-url="dbobjects.html" href="dbobjects.html">
                <span class="material-symbols-rounded" aria-hidden="true">database</span>
                <span>DB objekty</span>
            </a>
            <a class="nav-link" data-view="permissions" data-url="permissions.html" href="permissions.html">
                <span class="material-symbols-rounded" aria-hidden="true">admin_panel_settings</span>
                <span>Sprava prav</span>
            </a>
        </div>

        <div class="sidebar-section">
            <h4>Rychle akce</h4>
            <button class="nav-link" id="new-order-btn">
                <span class="material-symbols-rounded" aria-hidden="true">add_circle</span>
                <span>Nova objednavka</span>
            </button>
            <button class="nav-link" id="new-store-btn">
                <span class="material-symbols-rounded" aria-hidden="true">storefront</span>
                <span>Novy supermarket</span>
            </button>
        </div>

        <div class="sidebar-footer">
            <div class="sync-card">
                <div class="inbox-header">
                    <span class="material-symbols-rounded" aria-hidden="true">mark_email_unread</span>
                    <div>
                        <p class="muted-label">Inbox &amp; chat</p>
                        <strong><span id="message-unread">—</span> neprectene</strong>
                    </div>
                </div>
                <div class="inbox-last">
                    <p class="muted-label">Posledni zprava</p>
                    <div class="inbox-meta">
                        <span id="message-last-time">—</span>
                        <span id="message-last-from" class="muted-label"></span>
                    </div>
                    <p id="message-last-text" class="inbox-preview">Zadne zpravy</p>
                </div>
            </div>
        </div>
    </aside>

    <div class="workspace">
        <header class="topbar">
            <div>
                <p class="eyebrow" id="view-label">Hlavni panel</p>
                <h1 id="view-title">Rizeni operaci</h1>
            </div>
            <div class="topbar-right">
                <a class="nav-link topbar-icon-btn" data-view="chat" data-url="chat.html" href="chat.html" aria-label="Komunikace" title="Komunikace">
                    <span class="material-symbols-rounded" aria-hidden="true">forum</span>
                    <span class="topbar-icon-label">Komunikace</span>
                </a>
                <button class="nav-link" id="wallet-btn" style="width:auto; gap:6px; padding:8px 12px;">
                    <span class="material-symbols-rounded" aria-hidden="true">account_balance_wallet</span>
                    <span id="wallet-chip-balance">Penezenka</span>
                </button>
                <button class="nav-link" id="impersonation-exit-btn" style="display:none;width:auto;gap:6px;padding:8px 12px;">
                    <span class="material-symbols-rounded" aria-hidden="true">logout</span>
                    <span>Zpet k adminovi</span>
                </button>
                <div class="user-pill">
                    <div>
                        <strong id="user-name">Uzivatel</strong>
                        <small id="user-role">NEW_USER</small>
                    </div>
                    <button class="logout-btn" id="logout-btn">Odhlasit</button>
                </div>
            </div>
        </header>

        <div class="view-container">
            <section class="view active" data-view="dashboard">
                <div class="kpi-grid">
                    <article class="kpi-card">
                        <div class="kpi-label">SKU v obehu</div>
                        <div class="kpi-value" id="kpi-sku">—</div>
                        <div class="kpi-trend" id="kpi-sku-trend">0 kategorii</div>
                    </article>
                    <article class="kpi-card">
                        <div class="kpi-label">Aktivni objednavky</div>
                        <div class="kpi-value" id="kpi-orders">—</div>
                        <div class="kpi-trend" id="kpi-orders-trend">v praci</div>
                    </article>
                    <article class="kpi-card">
                        <div class="kpi-label">Tydenni obrat</div>
                        <div class="kpi-value" id="kpi-revenue">—</div>
                        <div class="kpi-trend">+8,6 % vs. plan</div>
                    </article>
                    <article class="kpi-card">
                        <div class="kpi-label">Kriticka SKU</div>
                        <div class="kpi-value" id="kpi-critical">—</div>
                        <div class="kpi-trend" id="kpi-critical-trend">bez rizik</div>
                    </article>
                </div>

                <div class="layout-stack" style="margin-top: 24px;">
                    <article class="panel">
                        <div style="display:flex;justify-content:space-between;align-items:center;">
                            <div>
                                <h2>Poptavka &amp; dodavky</h2>
                                <p>Data z OBJEDNAVKA + PLATBA</p>
                            </div>
                            <span class="badge">7 dnu</span>
                        </div>
                        <div id="demand-chart" class="demand-grid"></div>
                    </article>

                    <article class="panel">
                        <div style="display:flex;justify-content:space-between;align-items:center;">
                            <div>
                                <h2>Zdravi prodejen</h2>
                                <p>VIEW V_SUPERMARKET_HEALTH</p>
                            </div>
                            <span class="badge ghost">real-time</span>
                        </div>
                        <div class="health-grid" id="store-health-grid"></div>
                    </article>

                    <div class="two-column">
                        <article class="panel">
                            <h2>Rizikove zasoby</h2>
                            <ul id="low-stock-list"></ul>
                        </article>
                        <article class="panel">
                            <h2>Stavy retezce</h2>
                            <div id="overall-status-board"></div>
                        </article>
                    </div>

                    <article class="panel">
                        <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;">
                            <div>
                                <h2>Prodejny &amp; sklady</h2>
                                <p>SUPERMARKET • SKLAD • ADRESA</p>
                            </div>
                            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;">
                                <button type="button" class="ghost-btn" id="store-add-btn">Přidat</button>
                                <button type="button" class="ghost-btn ghost-strong" id="store-edit-btn" disabled>Upravit</button>
                                <button type="button" class="ghost-btn ghost-muted" id="store-delete-btn" disabled>Smazat</button>
                                <button class="logout-btn" id="export-store-btn">Export</button>
                            </div>
                        </div>
                        <div class="table-wrapper">
                            <table id="stores-table" class="interactive-table">
                                <thead>
                                <tr>
                                    <th>prodejna</th>
                                    <th>mesto</th>
                                    <th>adresa</th>
                                    <th>sklad</th>
                                    <th>manager</th>
                                    <th>status</th>
                                </tr>
                                </thead>
                                <tbody id="stores-table-body"></tbody>
                            </table>
                        </div>
                    </article>
                </div>
            </section>

            <section class="view" data-view="profile">
                <div class="profile-layout">
                    <article class="panel profile-hero-panel" id="profile-overview"></article>
                    <div class="profile-side">
                        <article class="panel profile-preferences-panel" id="profile-preferences"></article>
                        <article class="panel profile-security-panel" id="profile-security"></article>
                    </div>
                </div>
            </section>

            <section class="view" data-view="permissions">
                <div class="panel">
                    <div style="display:flex;justify-content:space-between;align-items:center;">
                        <div>
                            <h2 id="permission-form-title">Nove pravo</h2>
                            <p>Definice systemovych opravneni</p>
                        </div>
                        <button class="ghost-btn ghost-muted" id="permission-reset-btn">Vycistit</button>
                    </div>
                    <form id="permission-form" class="profile-form-section" style="margin-top:20px;">
                        <input type="hidden" name="permissionId">
                        <div class="profile-form-grid">
                            <label><span>Nazev</span><input type="text" name="name" required></label>
                            <label><span>Kod</span><input type="text" name="code" required></label>
                            <label style="grid-column:1/-1;">
                                <span>Popis</span>
                                <textarea name="description" rows="2" style="width:100%;border:1px solid var(--border);border-radius:14px;padding:12px;"></textarea>
                            </label>
                        </div>
                        <div style="margin-top:12px;display:flex;gap:12px;">
                            <button type="submit" class="ghost-btn ghost-strong">Ulozit</button>
                            <button type="button" class="ghost-btn ghost-muted" id="permission-cancel-btn">Zrusit</button>
                        </div>
                    </form>
                </div>
                <div class="panel">
                    <h2>Prehled prav</h2>
                    <p class="profile-muted" style="margin-top:-8px;">Seznam existujicich prav a jejich prirazeni k rolim</p>
                    <div id="permissions-table" style="margin-top:16px;"></div>
                </div>
            </section>

            <section class="view" data-view="inventory">
                <div class="market-grid">
                    <article class="panel market-panel">
                        <div class="market-panel-header">
                            <div>
                                <h2>Supermarkety</h2>
                                <p class="profile-muted">SUPERMARKET</p>
                            </div>
                            <button type="button" class="ghost-btn ghost-strong" id="supermarket-add-btn">Novy zaznam</button>
                        </div>
                        <p class="profile-muted market-status" id="supermarket-status"></p>
                        <div class="table-wrapper scroll-x market-scroll">
                            <table class="fixed">
                                <thead>
                                <tr>
                                    <th>Nazev</th>
                                    <th>Telefon</th>
                                    <th>Email</th>
                                    <th>Adresa</th>
                                    <th>Akce</th>
                                </tr>
                                </thead>
                                <tbody id="market-supermarket-body"></tbody>
                            </table>
                        </div>
                    </article>

                    <article class="panel market-panel market-panel-wide">
                        <div class="market-panel-header">
                            <div>
                                <h2>Zbozi</h2>
                                <p class="profile-muted">ZBOZI</p>
                            </div>
                            <button type="button" class="ghost-btn ghost-strong" id="goods-add-btn">Novy zaznam</button>
                        </div>
                        <p class="profile-muted market-status" id="goods-status"></p>
                        <div class="table-wrapper scroll-x market-scroll tall">
                            <table class="fixed">
                                <thead>
                                <tr>
                                    <th>Nazev</th>
                                    <th>Kategorie</th>
                                    <th>Sklad</th>
                                    <th>Mnozstvi</th>
                                    <th>Cena</th>
                                    <th>Akce</th>
                                </tr>
                                </thead>
                                <tbody id="market-goods-body"></tbody>
                            </table>
                        </div>
                    </article>

                    <article class="panel market-panel">
                        <div class="market-panel-header">
                            <div>
                                <h2>Sklady</h2>
                                <p class="profile-muted">SKLAD</p>
                            </div>
                            <button type="button" class="ghost-btn ghost-strong" id="warehouse-add-btn">Novy zaznam</button>
                        </div>
                        <p class="profile-muted market-status" id="warehouse-status"></p>
                        <div class="table-wrapper scroll-x market-scroll">
                            <table class="fixed">
                                <thead>
                                <tr>
                                    <th>Nazev</th>
                                    <th>Supermarket</th>
                                    <th>Kapacita</th>
                                    <th>Telefon</th>
                                    <th>Akce</th>
                                </tr>
                                </thead>
                                <tbody id="market-warehouse-body"></tbody>
                            </table>
                        </div>
                    </article>
                </div>
            </section>

            <section class="view" data-view="orders">
                <article class="panel">
                    <div style="display:flex;justify-content:space-between;align-items:center;">
                        <div>
                            <h2>Objednavky (OBJEDNAVKA)</h2>
                            <p>Kliknutim zobrazite polozky</p>
                        </div>
                        <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;">
                            <span class="badge" id="orders-count">0</span>
                            <div style="display:flex;gap:8px;flex-wrap:wrap;">
                                <button type="button" class="ghost-btn" id="order-edit-btn" disabled>Editovat</button>
                                <button type="button" class="ghost-btn ghost-muted" id="order-delete-btn" disabled>Smazat</button>
                            </div>
                        </div>
                    </div>
                    <div class="table-wrapper">
                        <table class="orders-table">
                            <thead>
                            <tr>
                                <th>cislo</th>
                                <th>typ</th>
                                <th>prodejna</th>
                                <th>uzivatel</th>
                                <th>status</th>
                                <th>datum</th>
                                <th>castka</th>
                            </tr>
                            </thead>
                            <tbody id="orders-table-body"></tbody>
                        </table>
                    </div>
                </article>

                <div class="two-column">
                    <article class="panel">
                        <h2>Statusy (OBJEDNAVKA_STATUS)</h2>
                        <div id="order-status-board"></div>
                    </article>

                    <article class="panel">
                        <div style="display:flex;justify-content:space-between;align-items:center;">
                            <h2 id="order-lines-title">Slozeni objednavky</h2>
                            <span class="badge" id="order-lines-badge">nevybrano</span>
                        </div>
                        <ul id="order-lines"></ul>
                    </article>
                </div>
            </section>

            <div class="modal" id="order-modal" aria-hidden="true">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="order-modal-title">Nova objednavka</h3>
                        <button type="button" class="ghost-btn ghost-muted" id="order-modal-close">Zavrit</button>
                    </div>
                    <form id="order-form" class="profile-form-section">
                        <div class="profile-form-grid">
                            <label><span>Typ</span>
                                <select id="order-type" name="type" required></select>
                            </label>
                            <label><span>Prodejna</span>
                                <select id="order-store" name="store" required></select>
                            </label>
                            <label><span>Uzivatel</span>
                                <select id="order-employee" name="employee" required></select>
                            </label>
                            <label><span>Status</span>
                                <select id="order-status" name="status" required></select>
                            </label>
                            <label><span>Datum</span>
                                <input type="datetime-local" id="order-date" name="date">
                            </label>
                            <label style="grid-column:1/-1;">
                                <span>Poznamka</span>
                                <textarea id="order-note" name="note" rows="3" style="width:100%;"></textarea>
                            </label>
                        </div>
                        <div style="margin-top:12px;display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
                            <button type="submit" class="ghost-btn ghost-strong" id="order-save-btn">Ulozit</button>
                            <button type="button" class="ghost-btn ghost-muted" id="order-cancel-btn">Zrusit</button>
                            <span class="profile-muted" id="order-form-status"></span>
                        </div>
                    </form>
                </div>
            </div>

            <div class="modal" id="market-editor-modal" aria-hidden="true">
                <div class="modal-content market-modal">
                    <div class="modal-header">
                        <h3 id="market-modal-title">Zaznam</h3>
                        <button type="button" class="ghost-btn ghost-muted" data-market-close>&times;</button>
                    </div>
                    <form id="market-editor-form" class="market-form">
                        <div class="market-form-grid" id="market-form-fields"></div>
                        <div class="modal-actions">
                            <button type="button" class="ghost-btn ghost-muted" id="market-delete-btn">Smazat zaznam</button>
                            <div style="display:flex;gap:8px;flex-wrap:wrap;">
                                <button type="button" class="ghost-btn" data-market-close>Zavrit</button>
                                <button type="submit" class="ghost-btn ghost-strong">Ulozit</button>
                            </div>
                        </div>
                        <p class="form-msg" id="market-form-status"></p>
                    </form>
                </div>
            </div>

            <section class="view" data-view="people">
                <article class="panel" id="role-summary-panel">
                    <h2>Prehled roli</h2>
                    <div id="role-summary-list"></div>
                </article>

                <article class="panel admin-users-panel" id="admin-users-panel">
                    <div style="display:flex;justify-content:space-between;align-items:center;gap:16px;flex-wrap:wrap;">
                        <div>
                            <h2>Uzivatele systemu</h2>
                            <p class="profile-muted">Sprava vsech registrovanych uzivatelu</p>
                        </div>
                        <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;">
                            <label style="display:flex;align-items:center;gap:8px;">
                                <span>Role</span>
                                <select id="admin-users-role-filter" style="padding:8px 12px;border-radius:12px;border:1px solid var(--border);">
                                    <option value="">Vsechny role</option>
                                </select>
                            </label>
                            <label style="display:flex;align-items:center;gap:8px;">
                                <span>Hledat</span>
                                <input type="search" id="admin-users-search" placeholder="Jmeno nebo email" style="padding:8px 12px;border-radius:12px;border:1px solid var(--border);">
                            </label>
                        </div>
                    </div>
                    <div id="admin-users-table" style="margin-top:16px;"></div>
                </article>

                <div class="modal" id="user-edit-modal" aria-hidden="true">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 id="user-edit-title">Upravit uzivatele</h3>
                            <button type="button" class="ghost-btn ghost-muted" id="user-edit-close">Zavrit</button>
                        </div>
                        <form id="user-edit-form" class="profile-form-section">
                            <div class="profile-form-grid">
                                <label><span>Jmeno</span><input type="text" name="firstName" required></label>
                                <label><span>Prijmeni</span><input type="text" name="lastName" required></label>
                        <label><span>E-mail</span><input type="email" name="email" required></label>
                        <label><span>Telefon</span><input type="tel" name="phone" required></label>
                        <label><span>Role</span><select name="roleCode" required></select></label>
                        <label data-role-section="employee"><span>Pozice</span><select name="position"></select></label>
                        <label data-role-section="employee"><span>Mzda (Kc)</span><input type="number" name="salary" min="0" step="0.01"></label>
                        <label data-role-section="employee"><span>Datum nastupu</span><input type="date" name="hireDate"></label>
                        <label><span>Ulice</span><input type="text" name="street" required></label>
                        <label><span>Cislo popisne</span><input type="text" name="houseNumber" required></label>
                        <label><span>Cislo orientacni</span><input type="text" name="orientationNumber" required></label>
                        <label><span>Mesto</span>
                            <input type="text" name="cityPsc" list="admin-city-options" class="city-picker" placeholder="PSC nebo nazev" required>
                            <datalist id="admin-city-options"></datalist>
                        </label>
                        <label data-role-section="customer"><span>Vernostni karta</span><input type="text" name="loyaltyCard"></label>
                        <label data-role-section="supplier"><span>Spolecnost</span><input type="text" name="supplierCompany"></label>
                        <label><span>Nove heslo</span><input type="password" name="newPassword"></label>
                    </div>
                            <div style="margin-top:16px;display:flex;gap:12px;">
                                <button type="submit" class="ghost-btn ghost-strong">Ulozit</button>
                                <button type="button" class="ghost-btn ghost-muted" id="user-edit-cancel">Zrusit</button>
                            </div>
                        </form>
                    </div>
                </div>
            </section>

            <section class="view" data-view="finance">
                <article class="panel">
                    <div style="display:flex;justify-content:space-between;align-items:center;">
                        <div>
                            <h2>Platby (PLATBA)</h2>
                            <p>Vcetne HOTOVOST / KARTA + UCTENKA</p>
                        </div>
                        <div>
                            <button class="chip active" data-payment-filter="all">Vse</button>
                            <button class="chip" data-payment-filter="K">Karty</button>
                            <button class="chip" data-payment-filter="H">Hotove</button>
                            <button class="chip" data-payment-filter="U">Ucet</button>
                        </div>
                    </div>
                    <div class="table-wrapper finance-table-wrapper">
                        <table class="payments-table">
                            <thead>
                            <tr>
                                <th>Typ</th>
                                <th>Metoda</th>
                                <th>Castka</th>
                                <th>Datum</th>
                            </tr>
                            </thead>
                            <tbody id="payments-table-body"></tbody>
                        </table>
                    </div>
                </article>

                <article class="panel">
                    <h2>Struktura prijmu</h2>
                    <div id="payment-stats"></div>
                </article>
            </section>

            <section class="view" data-view="dbobjects">
                <article class="panel">
                    <div style="display:flex;justify-content:space-between;align-items:center;gap:16px;flex-wrap:wrap;">
                        <div>
                            <p class="eyebrow">Systemovy katalog</p>
                            <h2>Databazove objekty</h2>
                            <p class="profile-muted">Vypis tabulek, pohledu, procedur, triggeru, sekvenci a indexu pouzitych v semestralce.</p>
                        </div>
                        <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
                            <input type="search" id="dbobj-search" class="search-field" placeholder="Hledat nazev nebo typ…" autocomplete="off">
                            <div class="pill-select">
                                <span class="pill-label">Typ</span>
                                <select id="dbobj-type-filter" class="pill-select-control">
                                    <option value="">Vsechny typy</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="table-wrapper" style="margin-top:16px;">
                        <table class="data-table">
                            <thead>
                            <tr>
                                <th>Typ</th>
                                <th>Nazev</th>
                                <th>Vytvoreno</th>
                                <th>Posl. DDL</th>
                                <th style="width:120px;">Akce</th>
                            </tr>
                            </thead>
                            <tbody id="dbobj-table-body">
                            <tr><td colspan="5" style="text-align:center;">Nacitam…</td></tr>
                            </tbody>
                        </table>
                    </div>
                </article>
            </section>

            <div class="modal" id="dbobj-modal" aria-hidden="true">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="dbobj-modal-title">DDL objektu</h3>
                        <button type="button" class="ghost-btn ghost-muted" id="dbobj-modal-close">Zavrit</button>
                    </div>
                    <span id="dbobj-ddl-status" class="profile-muted"></span>
                    <pre id="dbobj-modal-content" class="code-block" style="max-height:420px;overflow:auto;margin-top:8px;">-- Vyberte objekt a kliknete na Zobrazit</pre>
                </div>
            </div>

            <section class="view" data-view="records">
                <header class="archive-hero" style="margin-bottom:16px;">
                    <div>
                        <p class="eyebrow">ARCHIV</p>
                        <h2>Archiv &amp; audit</h2>
                        <p class="muted">Hierarchie slozek, soubory, posledni logy.</p>
                    </div>
                </header>

                <div class="archive-layout">
                    <section class="panel" style="grid-area:tree;">
                        <div class="section-head">
                            <div>
                                <p class="eyebrow">Struktura</p>
                                <h3>Strom slozek</h3>
                            </div>
                        </div>
                        <div id="folder-tree" class="archive-tree"></div>
                    </section>

                    <section class="panel audit-panel" style="grid-area:audit;">
                        <div class="section-head">
                            <div>
                                <p class="eyebrow">Audit</p>
                                <h3>Auditni zaznamy</h3>
                            </div>
                            <div class="upload-row">
                                <input type="file" id="file-upload-input" style="display:none;" />
                                <button class="logout-btn primary" id="file-upload-btn" type="button">Nahrat soubor</button>
                                <div class="report-trigger">
                                    <select id="report-month-select" aria-label="Mesic reportu"></select>
                                    <button class="ghost-btn ghost-strong" type="button" id="report-generate-btn">Reporty</button>
                                </div>
                                <small id="upload-hint" class="muted"></small>
                            </div>
                        </div>
                        <div class="table-wrapper scroll-x">
                            <table>
                                <thead id="audit-table-head"></thead>
                                <tbody id="file-table-body"></tbody>
                            </table>
                        </div>
                        <div id="log-detail-card" class="log-detail-card" aria-live="polite"></div>
                    </section>
                </div>
            </section>

            <section class="view" data-view="chat">
                <div class="chat-grid" id="chat-grid">
                    <article class="panel chat-people-panel">
                        <div class="chat-panel-header">
                            <div>
                                <h2>Kontakty</h2>
                                <p class="profile-muted">Vyberte uzivatele nebo zadejte e-mail rucne.</p>
                            </div>
                        </div>
                        <label class="chat-search">
                            <span class="material-symbols-rounded" aria-hidden="true">search</span>
                            <input type="search" id="chat-contact-search" placeholder="Hledat podle jmena nebo e-mailu…">
                        </label>
                        <div id="chat-people-list" class="chat-people-list"></div>
                    </article>
                    <article class="panel chat-panel">
                        <button class="chat-panel-toggle" id="chat-collapse-btn" type="button" aria-label="Zavrit chat" title="Zavrit chat">
                            <span class="material-symbols-rounded" aria-hidden="true">chevron_left</span>
                        </button>
                        <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:16px;flex-wrap:wrap;">
                            <div>
                                <h2>Interni chat</h2>
                                <p id="chat-selected-label" class="profile-muted">Vyberte kontakt vlevo nebo pouzijte vyhledavani.</p>
                            </div>
                            <div class="chat-actions">
                                <button class="ghost-btn" id="chat-select-toggle" type="button">Vybrat</button>
                                <div class="chat-actions-secondary">
                                    <button class="ghost-btn ghost-muted" id="chat-edit-btn" type="button" disabled>Upravit</button>
                                    <button class="ghost-btn ghost-danger" id="chat-delete-btn" type="button" disabled>Smazat</button>
                                </div>
                            </div>
                            <div class="chat-push-toggle" id="chat-push-toggle" role="switch" aria-checked="false">
                                <div class="chat-push-track">
                                    <span class="chat-push-text" id="chat-push-text">Push off</span>
                                    <div class="chat-push-knob"></div>
                                </div>
                            </div>
                        </div>
                        <div class="chat-feed" id="chat-feed"></div>
                        <form id="chat-form" class="chat-form">
                            <input type="hidden" id="chat-receiver">
                            <div class="chat-form-grid">
                                <label class="chat-message-field">
                                    <span>Zprava</span>
                                    <textarea id="chat-message" rows="3" placeholder="Napiste zpravu…"></textarea>
                                </label>
                                <div class="chat-emoji">
                                    <button type="button" class="ghost-btn ghost-muted" id="chat-emoji-btn" aria-expanded="false">??</button>
                                    <div class="chat-emoji-panel" id="chat-emoji-panel" hidden>
                                        <!-- obsah vlozi JS -->
                                    </div>
                                </div>
                            </div>
                            <div class="chat-form-actions">
                                <button type="submit" class="ghost-btn ghost-strong">Odeslat</button>
                                <span id="chat-form-status" class="profile-muted"></span>
                            </div>
                        </form>
                    </article>
                </div>
            </section>

            <section class="view" data-view="customer">
                <article class="panel">
                    <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:12px;flex-wrap:wrap;">
                        <div>
                            <h2>Zakaznicky vyber produktu</h2>
                            <p>Filtrujte podle kategorii a pridejte polozky do kosiku.</p>
                        </div>
                        <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;">
                            <a class="nav-link cart-icon" id="customer-cart-button" data-view="customer-cart" href="cart.html" aria-label="Muj kosik">
                                <span class="material-symbols-rounded" aria-hidden="true">shopping_cart</span>
                                <span class="cart-count" id="customer-cart-count">0</span>
                            </a>
                            <select id="customer-store-select" class="chip" style="min-width:180px;height:38px;padding:8px 12px;">
                                <option value="">Vyber prodejnu</option>
                            </select>
                            <div class="search" style="max-width:260px;min-width:200px;">
                                <span class="material-symbols-rounded" aria-hidden="true">search</span>
                                <input type="search" id="customer-search" placeholder="Hledat produkt podle nazvu nebo SKU">
                            </div>
                            <div id="customer-category-chips" style="display:flex;gap:8px;flex-wrap:wrap;"></div>
                        </div>
                    </div>
                    <div id="customer-product-grid" class="card-list" style="margin-top:12px;"></div>
                </article>
                <article class="panel">
                    <h2>Doporuceni</h2>
                    <div id="customer-suggestions"></div>
                </article>
            </section>

            <section class="view" data-view="customer-cart">
                <article class="panel">
                    <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;">
                        <div>
                            <h2>Muj kosik</h2>
                            <p>Upravte mnozstvi polozek, pote pokracujte k platbe.</p>
                        </div>
                        <a class="nav-link" data-view="customer" href="customer.html" style="width:auto;gap:8px;padding:8px 12px;">Zpet</a>
                    </div>
                    <div id="customer-cart-page" data-customer-cart style="margin-top:12px;"></div>
                </article>
            </section>

            <section class="view" data-view="customer-payment">
                <article class="panel">
                    <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;">
                        <div>
                            <h2>Platba</h2>
                            <p>Souhrn objednavky a volba metody platby.</p>
                        </div>
                        <a class="nav-link" data-view="customer-cart" href="cart.html" style="width:auto;gap:8px;padding:8px 12px;">Zpet do kosiku</a>
                    </div>
                    <div class="payment-summary">
                        <p>Celkem k uhrade: <strong id="payment-total">—</strong></p>
                    </div>
                    <form id="payment-form" class="payment-form">
                        <div class="pill-select">
                            <span class="pill-label">Metoda</span>
                            <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
                                <label style="display:flex;align-items:center;gap:6px;">
                                    <input type="radio" name="paymentType" value="CASH" checked>
                                    <span>Hotove</span>
                                </label>
                                <label style="display:flex;align-items:center;gap:6px;">
                                    <input type="radio" name="paymentType" value="CARD">
                                    <span>Kartou</span>
                                </label>
                                <label style="display:flex;align-items:center;gap:6px;">
                                    <input type="radio" name="paymentType" value="WALLET">
                                    <span>Uctem</span>
                                </label>
                            </div>
                        </div>

                        <div id="cash-section" class="payment-section">
                            <label>
                                <span>Hotovost prijata</span>
                                <input type="number" id="cash-given" name="cashGiven" min="0" step="0.01" placeholder="Zadejte castku">
                            </label>
                            <p class="profile-muted">Vratit: <strong id="cash-change">0 Kc</strong></p>
                        </div>

                        <div id="card-section" class="payment-section" style="display:none;">
                            <label>
                                <span>Cislo karty</span>
                                <input type="text" id="card-number" name="cardNumber" inputmode="numeric" autocomplete="cc-number" placeholder="1234 5678 9012 3456">
                            </label>
                        </div>

                        <div class="form-actions" style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
                            <button type="submit" class="ghost-btn ghost-strong">Zaplatit</button>
                            <button type="button" class="ghost-btn ghost-muted" id="payment-back">Zpet</button>
                            <span id="payment-status" class="profile-muted"></span>
                        </div>
                    </form>
                </article>
            </section>

            <section class="view" data-view="client-orders">
                <article class="panel">
                    <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;">
                        <div>
                            <h2>Zakaznicke objednavky</h2>
                            <p>Sprava fronty zakaznickych objednavek, vlastnich pripadu a historie.</p>
                        </div>
                        <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;">
                            <span class="badge" id="client-orders-count">0</span>
                            <button class="ghost-btn" type="button" id="client-orders-refresh">Obnovit</button>
                        </div>
                    </div>
                    <div id="client-orders-alert" class="profile-muted" style="margin-top:4px;"></div>
                    <div class="supplier-layout" style="margin-top:16px;">
                        <section class="supplier-section">
                            <div class="supplier-section-head">
                                <div>
                                    <p class="eyebrow" style="margin:0;">Fronta</p>
                                    <h3 style="margin:4px 0 6px;">Volne objednavky</h3>
                                    <p class="profile-muted" style="margin:0;">Bez prirazeneho obsluhujiciho.</p>
                                </div>
                                <span class="badge" id="client-queue-count">0</span>
                            </div>
                            <div class="supplier-section-body">
                                <div id="client-queue-container" class="supplier-orders-grid supplier-scroll"></div>
                                <div id="client-queue-empty" class="empty-state" style="display:none;text-align:center;padding:32px;">
                                    <span class="material-symbols-rounded" style="font-size:44px;color:var(--muted-fg);">hourglass_empty</span>
                                    <h3 style="margin-top:12px;font-size:1.1rem;">Zadne volne objednavky</h3>
                                    <p class="profile-muted">Jakmile se objevi nova objednavka, uvidite ji zde.</p>
                                </div>
                            </div>
                        </section>
                        <section class="supplier-section">
                            <div class="supplier-section-head">
                                <div>
                                    <p class="eyebrow" style="margin:0;">Sledovane</p>
                                    <h3 style="margin:4px 0 6px;">Moje pripady</h3>
                                    <p class="profile-muted" style="margin:0;">Objednavky, ktere obsluhujete.</p>
                                </div>
                                <span class="badge" id="client-mine-count">0</span>
                            </div>
                            <div class="supplier-section-body">
                                <div id="client-mine-container" class="supplier-mine-list supplier-scroll"></div>
                                <div id="client-mine-empty" class="empty-state" style="display:none;text-align:center;padding:32px;">
                                    <span class="material-symbols-rounded" style="font-size:44px;color:var(--muted-fg);">assignment_turned_in</span>
                                    <h3 style="margin-top:12px;font-size:1.1rem;">Nic nesledujete</h3>
                                    <p class="profile-muted">Prevezmete objednavku z fronty a zobrazi se zde.</p>
                                </div>
                            </div>
                        </section>
                        <section class="supplier-section">
                            <div class="supplier-section-head">
                                <div>
                                    <p class="eyebrow" style="margin:0;">Chronologie</p>
                                    <h3 style="margin:4px 0 6px;">Historie</h3>
                                    <p class="profile-muted" style="margin:0;">Dokoncene nebo zrusene zakaznicke objednavky.</p>
                                </div>
                                <div class="supplier-history-actions">
                                    <span class="badge" id="client-history-count">0</span>
                                    <button type="button" class="ghost-btn ghost-muted" id="client-history-toggle" aria-expanded="false" aria-controls="client-history-section">Zobrazit historii</button>
                                </div>
                            </div>
                            <div class="supplier-section-body" id="client-history-section" hidden>
                                <div id="client-history-container" class="supplier-mine-list supplier-scroll"></div>
                                <div id="client-history-empty" class="empty-state" style="display:none;text-align:center;padding:32px;">
                                    <span class="material-symbols-rounded" style="font-size:44px;color:var(--muted-fg);">history</span>
                                    <h3 style="margin-top:12px;font-size:1.1rem;">Zadne polozky</h3>
                                    <p class="profile-muted">Po dokonceni nebo zruseni se objednavky objevi zde.</p>
                                </div>
                            </div>
                        </section>
                        <section class="supplier-section">
                            <div class="supplier-section-head">
                                <div>
                                    <p class="eyebrow" style="margin:0;">Refundy k potvrzeni</p>
                                    <h3 style="margin:4px 0 6px;">Ceka na schvaleni</h3>
                                    <p class="profile-muted" style="margin:0;">Zakaznici pozadali o vraceni penez.</p>
                                </div>
                                <span class="badge" id="client-refund-count">0</span>
                            </div>
                            <div class="supplier-section-body">
                                <div id="client-refund-container" class="supplier-orders-grid supplier-scroll"></div>
                                <div id="client-refund-empty" class="empty-state" style="display:none;text-align:center;padding:32px;">
                                    <span class="material-symbols-rounded" style="font-size:44px;color:var(--muted-fg);">undo</span>
                                    <h3 style="margin-top:12px;font-size:1.1rem;">Zadne refundy</h3>
                                    <p class="profile-muted">Az zakaznik pozada o refund, objevi se zde.</p>
                                </div>
                            </div>
                        </section>
                    </div>
                </article>
            </section>

            <section class="view" data-view="customer-history">
                <article class="panel">
                    <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;">
                        <div>
                            <h2>Historie zakaznika</h2>
                            <p>Vase uzavrene objednavky vcetne polozek.</p>
                        </div>
                        <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;">
                            <span class="badge" id="customer-history-count">0</span>
                            <button class="ghost-btn" type="button" id="customer-history-refresh">Obnovit</button>
                        </div>
                    </div>
                    <div id="customer-history-alert" class="profile-muted" style="margin-top:4px;"></div>
                    <div class="table-wrapper customer-table-wrapper" style="margin-top:12px;">
                        <table class="data-table">
                            <thead>
                            <tr>
                                <th>Prodejna</th>
                                <th>Status</th>
                                <th>Datum</th>
                                <th>Castka</th>
                                <th>Polozky</th>
                                <th>Akce</th>
                            </tr>
                            </thead>
                            <tbody id="customer-history-body">
                            <tr><td colspan="6" style="text-align:center;" class="profile-muted">Nacitam…</td></tr>
                            </tbody>
                        </table>
                    </div>
                </article>
            </section>

            <section class="view" data-view="supplier">
                <article class="panel">
                    <div class="supplier-hero">
                        <p class="eyebrow" style="margin:0;">Dodavatel</p>
                        <h2 style="margin:4px 0 6px;">Dodavatelske objednavky</h2>
                        <p class="profile-muted" style="margin:0;">Sleduj dostupne objednavky a spravuj ty, ktere jsi prevzal.</p>
                    </div>
                    <div class="supplier-layout">
                        <section class="supplier-section">
                            <div class="supplier-section-head">
                                <div>
                                    <p class="eyebrow" style="margin:0;">Fronta</p>
                                    <h3 style="margin:4px 0 6px;">Volne objednavky</h3>
                                    <p class="profile-muted" style="margin:0;">Objednavky cekajici na prevzeti.</p>
                                </div>
                                <span class="badge" id="supplier-orders-count">0</span>
                            </div>
                            <div class="supplier-section-body">
                                <div id="supplier-orders-container" class="supplier-orders-grid supplier-scroll">

                                </div>
                                <div id="supplier-orders-empty" class="empty-state" style="display: none; text-align: center; padding: 32px;">
                                    <span class="material-symbols-rounded" style="font-size: 44px; color: var(--muted-fg);">local_shipping</span>
                                    <h3 style="margin-top: 12px;font-size:1.1rem;">Zadne volne objednavky</h3>
                                    <p class="profile-muted">Momentalne nejsou k dispozici zadne nove objednavky k prevzeti.</p>
                                </div>
                            </div>
                        </section>
                        <section class="supplier-section">
                            <div class="supplier-section-head">
                                <div>
                                    <p class="eyebrow" style="margin:0;">Prevzate</p>
                                    <h3 style="margin:4px 0 6px;">Moje objednavky</h3>
                                    <p class="profile-muted" style="margin:0;">Prevzate objednavky a jejich stav.</p>
                                </div>
                                <span class="badge" id="supplier-mine-count">0</span>
                            </div>
                            <div class="supplier-section-body">
                                <div id="supplier-mine-container" class="supplier-mine-list supplier-scroll">

                                </div>
                                <div id="supplier-mine-empty" class="empty-state" style="display: none; text-align: center; padding: 32px;">
                                    <span class="material-symbols-rounded" style="font-size: 44px; color: var(--muted-fg);">assignment_turned_in</span>
                                    <h3 style="margin-top: 12px;font-size:1.1rem;">Zatim nemas zadne objednavky</h3>
                                    <p class="profile-muted">Prevzit muzes nekterou z volnych objednavek vlevo.</p>
                                </div>
                            </div>
                        </section>
                        <section class="supplier-section">
                            <div class="supplier-section-head">
                                <div>
                                    <p class="eyebrow" style="margin:0;">Chronologie</p>
                                    <h3 style="margin:4px 0 6px;">Historie objednavek</h3>
                                    <p class="profile-muted" style="margin:0;">Dokoncene nebo zrusene zakazky.</p>
                                </div>
                                <div class="supplier-history-actions">
                                    <span class="badge" id="supplier-history-count">0</span>
                                    <button type="button" class="ghost-btn ghost-muted" id="supplier-history-toggle" aria-expanded="false" aria-controls="supplier-history-section">Zobrazit historii</button>
                                </div>
                            </div>
                            <div class="supplier-section-body" id="supplier-history-section" hidden>
                                <div id="supplier-history-container" class="supplier-mine-list supplier-scroll">

                                </div>
                                <div id="supplier-history-empty" class="empty-state" style="display:none;text-align:center;padding:32px;">
                                    <span class="material-symbols-rounded" style="font-size:44px;color:var(--muted-fg);">history</span>
                                    <h3 style="margin-top:12px;font-size:1.1rem;">Zadne zakoncene objednavky</h3>
                                    <p class="profile-muted">Jakmile zakazku dokoncis nebo zrusis, objevi se zde.</p>
                                </div>
                            </div>
                        </section>
                    </div>
                </article>
            </section>
        </div>
    </div>
</div>

<div class="modal" id="file-preview-modal" aria-hidden="true">
    <div class="modal-content preview-modal">
        <div class="modal-header" style="align-items:flex-start;">
            <div>
                <p class="eyebrow">Nahled</p>
                <h3 id="file-preview-title">Soubor</h3>
            </div>
            <button type="button" class="ghost-btn ghost-muted" id="file-preview-close">Zavrit</button>
        </div>
        <div class="preview-actions">
            <div class="preview-actions-left">
                <button type="button" class="ghost-btn" id="file-preview-edit" style="display:none;">Upravit</button>
                <button type="button" class="ghost-btn ghost-strong" id="file-preview-save" style="display:none;">Ulozit zmeny</button>
            </div>
            <span id="file-preview-status" class="muted"></span>
        </div>
        <textarea id="file-preview-editor" class="preview-editor" style="display:none;" spellcheck="false"></textarea>
        <div class="preview-body">
            <iframe id="file-preview-frame" class="preview-frame" title="Nahled souboru"></iframe>
            <img id="file-preview-image" class="preview-image" alt="Nahled souboru" style="display:none;">
            <pre id="file-preview-text" class="preview-text" style="display:none;"></pre>
        </div>
        <div id="file-preview-error" class="muted" style="display:none;margin-top:10px;"></div>
    </div>
</div>

<div class="modal" id="dialog-modal" aria-hidden="true">
    <div class="modal-content dialog-modal">
        <div class="modal-header">
            <h3 id="dialog-title">Potvrzeni</h3>
        </div>
        <p id="dialog-message" class="muted"></p>
        <textarea id="dialog-input" class="preview-editor" style="display:none;" spellcheck="false"></textarea>
        <div class="dialog-actions">
            <button type="button" class="ghost-btn ghost-muted" id="dialog-cancel">Ne</button>
            <button type="button" class="ghost-btn ghost-strong" id="dialog-confirm">Ano</button>
        </div>
    </div>
</div>

<div class="modal" id="db-error-modal" aria-hidden="true">
    <div class="modal-content dialog-modal">
        <div class="modal-header" style="align-items:flex-start;">
            <div>
                <p class="eyebrow">Chyba databaze</p>
                <h3 id="db-error-title">Operace se nezdarila</h3>
            </div>
        </div>
        <p id="db-error-message" class="muted" style="white-space:pre-wrap;word-break:break-word;"></p>
        <pre id="db-error-detail"
             class="code-block"
             style="display:none;white-space:pre-wrap;word-break:break-word;max-height:60vh;overflow:auto;"></pre>
        <div class="dialog-actions" style="justify-content:flex-end;">
            <button type="button" class="ghost-btn ghost-strong" data-db-error-close>Rozumim</button>
        </div>
    </div>
</div>
